{% extends "layout.html" %}
{% block content %}
<h2>{% if current_user.is_admin %}Admin Dashboard{% else %}User Dashboard{% endif %}</h2>
<hr>

<div class="card shadow-sm">
    <div class="card-header bg-light">
        <h5 class="mb-0">API Key Management</h5>
    </div>
    <div class="card-body">
        <p class="text-muted">Use this key to authenticate your API requests. Keep it secret!</p>

        <div class="alert alert-secondary">
            <div
                class="d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between gap-2">
                <code class="fs-6" id="apiKey" style="word-break: break-all;">{{ current_user.api_key }}</code>
                <button class="btn btn-sm btn-outline-dark flex-shrink-0"
                    onclick="navigator.clipboard.writeText(document.getElementById('apiKey').innerText)">Copy</button>
            </div>
        </div>

        <div class="mt-4">
            <h6 class="text-danger">Danger Zone</h6>
            <p class="small text-muted">Regenerating your key will immediately invalidate the old one.
                Applications using the old key will stop working.</p>
            <form method="POST">
                <input type="hidden" name="action" value="regenerate_key">
                <button type="submit" class="btn btn-danger"
                    onclick="return confirm('Are you sure you want to regenerate your API Key? Old key will stop working immediately.')">Regenerate
                    API Key</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}